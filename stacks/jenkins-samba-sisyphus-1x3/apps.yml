---
samba_parameters: &samba_params
  samba_realm: "domain.alt" #"{{stack.domain}}"
  samba_domain: "domain" #"{{stack.domain.split('.')[0]}}"
  samba_admin_pass: peebieY4
  samba_dns_forward: 8.8.8.8
  samba_dns_backend: SAMBA_INTERNAL
  samba_master_hostname: dc0 # need to get it automatically somehow
  samba_master_address: 10.64.6.1 # need to get it automatically somehow
  samba_network: 10.64.6.0/24 # need to determine which interface should be used for samba connection

apt_sources_from_tasks: []
#  - "210899"
#  - {id: "207234", binds: [ "dc1", "cl0" ]}

apps:
- # step1
  - name: samba
    vars:
      <<: *samba_params
      samba_flavor: master
    binds:
    - "dc0"

- #step2
  - name: samba
    vars:
      <<: *samba_params
      samba_flavor: client
    binds: [ "clw0", "clw1", "clw2" ]

- #step3
  - name: samba
    vars:
      <<: *samba_params
      samba_flavor: gen_test_env
      samba_generate_domain_config: true
      samba_domain_config_output: ".tmp/domain_config"
    binds: [ "dc0" ]

- #step4
  - name: sssd-adgpo-test
    binds: ["dc0", "clw0", "clw1", "clw2" ]
    vars:
      <<: *samba_params
      samba_clients: [ "clw0", "clw1", "clw2" ]

